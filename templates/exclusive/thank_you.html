{% extends "exclusive/base_exclusive.html" %}

{% block title %}üéâ Gratulacje! Zam√≥wienie z≈Ço≈ºone{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/pages/exclusive/thank-you.css') }}?v=3">
{% endblock %}

{% block body_content %}
<div class="thank-you-page">
    <!-- Animated Background -->
    <div class="animated-bg">
        <div class="orb orb-1"></div>
        <div class="orb orb-2"></div>
        <div class="orb orb-3"></div>
        <div class="orb orb-4"></div>
        <div class="orb orb-5"></div>
        <div class="sparkle sparkle-1"></div>
        <div class="sparkle sparkle-2"></div>
        <div class="sparkle sparkle-3"></div>
        <div class="sparkle sparkle-4"></div>
        <div class="sparkle sparkle-5"></div>
        <div class="sparkle sparkle-6"></div>
        <div class="sparkle sparkle-7"></div>
        <div class="sparkle sparkle-8"></div>
        <div class="sparkle sparkle-9"></div>
        <div class="sparkle sparkle-10"></div>
        <div class="sparkle sparkle-11"></div>
        <div class="sparkle sparkle-12"></div>
        <div class="sparkle sparkle-13"></div>
        <div class="sparkle sparkle-14"></div>
        <div class="sparkle sparkle-15"></div>
    </div>

    <!-- Massive Hero Title -->
    <div class="hero-title-wrapper">
        <h1 class="hero-title">GRATULACJE!</h1>
        <div class="hero-subtitle">Twoje zam√≥wienie zosta≈Ço pomy≈õlnie z≈Ço≈ºone</div>
    </div>

    <div class="thank-you-container">
        <!-- Epic Success Icon with Counter Ring -->
        <div class="success-header">
            <div class="success-icon-wrapper">
                <!-- Rotating gradient ring -->
                <div class="gradient-ring"></div>
                <div class="gradient-ring ring-2"></div>

                <!-- Checkmark SVG -->
                <div class="success-icon" id="checkmark-icon">
                    <svg class="checkmark-svg" viewBox="0 0 52 52">
                        <circle class="checkmark-circle" cx="26" cy="26" r="25" fill="none"/>
                        <path class="checkmark-check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8"/>
                    </svg>
                </div>
            </div>

            <h2 class="success-message">Zam√≥wienie przyjƒôte!</h2>

            {% if order_data %}
            <div class="order-number-card">
                <span class="order-label">Tw√≥j numer zam√≥wienia</span>
                <div class="order-number" id="order-number" data-number="{{ order_data.order_number }}">
                    <span class="number-display">{{ order_data.order_number }}</span>
                </div>
            </div>
            {% endif %}
        </div>

        {% if current_user.is_authenticated %}
        <!-- LOGGED IN USER -->
        <div class="logged-user-section">
            <div class="message-box">
                <div class="icon-wrapper">
                    <svg width="24" height="24" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                        <path d="m10.97 4.97-.02.022-3.473 4.425-2.093-2.094a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-1.071-1.05z"/>
                    </svg>
                </div>
                <p>Twoje zam√≥wienie zosta≈Ço przyjƒôte i oczekuje na realizacjƒô. Mo≈ºesz ≈õledziƒá jego status w swoim panelu.</p>
            </div>

            <a href="{{ url_for('orders.client_list') }}" class="btn btn-primary btn-lg btn-epic">
                <span class="btn-text">Zobacz swoje zam√≥wienia</span>
                <span class="btn-arrow">‚Üí</span>
            </a>
        </div>

        {% elif order_data and order_data.is_guest %}
        <!-- GUEST USER - 2 OPTIONS -->
        <div class="guest-options">

            <!-- OPTION 1: Create Account -->
            <div class="option-card option-register">
                <div class="option-header">
                    <span class="recommended-badge">
                        <span class="badge-icon">‚≠ê</span>
                        <span>Zalecane</span>
                    </span>
                    <h3>Za≈Ç√≥≈º konto i ≈õled≈∫ zam√≥wienie</h3>
                </div>

                <ul class="benefits-list">
                    <li>
                        <svg width="20" height="20" viewBox="0 0 16 16" fill="currentColor">
                            <path d="M10.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425a.267.267 0 0 1 .02-.022z"/>
                        </svg>
                        <span>≈öledzenie statusu w czasie rzeczywistym</span>
                    </li>
                    <li>
                        <svg width="20" height="20" viewBox="0 0 16 16" fill="currentColor">
                            <path d="M10.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425a.267.267 0 0 1 .02-.022z"/>
                        </svg>
                        <span>Historia wszystkich zam√≥wie≈Ñ</span>
                    </li>
                    <li>
                        <svg width="20" height="20" viewBox="0 0 16 16" fill="currentColor">
                            <path d="M10.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425a.267.267 0 0 1 .02-.022z"/>
                        </svg>
                        <span>Szybsze kolejne zam√≥wienia</span>
                    </li>
                    <li>
                        <svg width="20" height="20" viewBox="0 0 16 16" fill="currentColor">
                            <path d="M10.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425a.267.267 0 0 1 .02-.022z"/>
                        </svg>
                        <span>Powiadomienia o zmianach</span>
                    </li>
                </ul>

                <form action="{{ url_for('auth.register_from_guest') }}" method="POST" class="register-form">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                    <input type="hidden" name="order_id" value="{{ order_data.order_id }}">
                    <input type="hidden" name="guest_token" value="{{ order_data.guest_view_token }}">

                    <!-- Pre-filled data -->
                    <div class="prefilled-info">
                        <div class="info-row">
                            <span class="label">Imiƒô i nazwisko:</span>
                            <span class="value">{{ order_data.guest_name }}</span>
                        </div>
                        <div class="info-row">
                            <span class="label">Email:</span>
                            <span class="value">{{ order_data.guest_email }}</span>
                        </div>
                        {% if order_data.guest_phone %}
                        <div class="info-row">
                            <span class="label">Telefon:</span>
                            <span class="value">{{ order_data.guest_phone }}</span>
                        </div>
                        {% endif %}
                    </div>

                    <!-- Password inputs -->
                    <div class="form-group">
                        <label for="password">Ustaw has≈Ço do konta</label>
                        <input type="password" id="password" name="password"
                               class="form-control" required minlength="8"
                               placeholder="Min. 8 znak√≥w">
                    </div>
                    <div class="form-group">
                        <label for="password_confirm">Potwierd≈∫ has≈Ço</label>
                        <input type="password" id="password_confirm" name="password_confirm"
                               class="form-control" required
                               placeholder="Powt√≥rz has≈Ço">
                    </div>

                    <button type="submit" class="btn btn-primary btn-lg btn-block btn-epic">
                        <span class="btn-text">Za≈Ç√≥≈º konto</span>
                        <span class="btn-arrow">‚Üí</span>
                    </button>
                </form>
            </div>

            <!-- SEPARATOR -->
            <div class="options-separator">
                <span>lub</span>
            </div>

            <!-- OPTION 2: Continue without account -->
            <div class="option-card option-guest">
                <div class="guest-icon">
                    <svg width="48" height="48" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H3Zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"/>
                    </svg>
                </div>
                <h3>Kontynuuj jako go≈õƒá</h3>
                <p>Mo≈ºesz ≈õledziƒá swoje zam√≥wienie u≈ºywajƒÖc specjalnego linku, kt√≥ry wys≈Çali≈õmy na Tw√≥j email.</p>

                <a href="{{ url_for('orders.guest_track', token=order_data.guest_view_token) }}"
                   class="btn btn-secondary btn-lg btn-epic">
                    <span class="btn-text">Zobacz status zam√≥wienia</span>
                    <span class="btn-arrow">‚Üí</span>
                </a>

                <p class="hint">
                    <svg width="14" height="14" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V4Zm2-1a1 1 0 0 0-1 1v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1H2Zm13 2.383-4.708 2.825L15 11.105V5.383Zm-.034 6.876-5.64-3.471L8 9.583l-1.326-.795-5.64 3.47A1 1 0 0 0 2 13h12a1 1 0 0 0 .966-.741ZM1 11.105l4.708-2.897L1 5.383v5.722Z"/>
                    </svg>
                    <span>Link wys≈Çany na <strong>{{ order_data.guest_email }}</strong></span>
                </p>
            </div>

        </div>

        {% else %}
        <!-- FALLBACK -->
        <div class="logged-user-section">
            <div class="message-box">
                <p>Twoje zam√≥wienie zosta≈Ço przyjƒôte i oczekuje na realizacjƒô.</p>
                <p class="text-muted">Szczeg√≥≈Çy zam√≥wienia zosta≈Çy wys≈Çane na podany adres email.</p>
            </div>
        </div>
        {% endif %}
    </div>

    <!-- Floating Action Buttons -->
    <div class="floating-actions">
        <!-- Audio Toggle -->
        <button id="audio-toggle" class="fab fab-audio" aria-label="W≈ÇƒÖcz muzykƒô" title="W≈ÇƒÖcz/wy≈ÇƒÖcz muzykƒô">
            <svg class="audio-icon" viewBox="0 0 16 16" fill="currentColor">
                <path d="M6.717 3.55A.5.5 0 0 1 7 4v8a.5.5 0 0 1-.812.39L3.825 10.5H1.5A.5.5 0 0 1 1 10V6a.5.5 0 0 1 .5-.5h2.325l2.363-1.89a.5.5 0 0 1 .529-.06z"/>
                <path d="M11.854 4.146a.5.5 0 0 1 0 .708L10.207 6.5l1.647 1.646a.5.5 0 0 1-.708.708L9.5 7.207 7.854 8.854a.5.5 0 1 1-.708-.708L8.793 6.5 7.146 4.854a.5.5 0 1 1 .708-.708L9.5 5.793l1.646-1.647a.5.5 0 0 1 .708 0z"/>
            </svg>
        </button>
    </div>

    <!-- Hidden Audio Element -->
    <audio id="celebration-audio" preload="auto" loop>
        <source src="{{ url_for('static', filename='audio/celebration.mp3') }}" type="audio/mpeg">
    </audio>

    <!-- Click counter for easter egg -->
    <div id="click-counter" data-count="0" style="display: none;"></div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/pages/exclusive/thank-you.js') }}?v=3"></script>
{% endblock %}
